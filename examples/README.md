# 测试示例文件

这个文件夹包含多种测试场景的HTML文件，用于验证表格导出器扩展的功能和性能。

## 文件列表

### 1. `simple-table.html` - 基础功能测试
**测试目标**: 验证扩展的基本功能
- ✅ 简单表格识别 (5×5)
- ✅ 中文字符处理
- ✅ 基础CSV导出
- ✅ 预览文本生成

**预期结果**: 识别1个表格，正确导出所有数据

---

### 2. `special-characters.html` - 特殊字符处理
**测试目标**: 验证CSV转义功能
- ✅ 逗号转义 (`"text,with,commas"`)
- ✅ 双引号转义 (`"text ""quoted"" content"`)
- ✅ 换行符处理 (`"line1\nline2"`)
- ✅ Unicode字符支持
- ✅ HTML标签清理

**预期结果**: 所有特殊字符正确转义，Excel兼容

---

### 3. `multiple-tables.html` - 多表格识别
**测试目标**: 测试多表格环境
- ✅ 检测5个不同大小的表格
- ✅ 独立导出每个表格
- ✅ 正确的预览文本生成
- ✅ 行列计数准确性

**预期结果**: 识别5个表格，每个都可独立导出

---

### 4. `merged-cells.html` - 合并单元格处理
**测试目标**: 验证复杂表格结构
- ⚠️ 横向合并 (`colspan`)
- ⚠️ 纵向合并 (`rowspan`)
- ⚠️ 复杂嵌套合并
- ✅ 程序稳定性（不崩溃）

**注意**: CSV格式不支持单元格合并，导出结果可能包含空白单元格

---

### 5. `large-table.html` - 性能测试
**测试目标**: 验证大数据量处理
- ⚡ 100行×10列=1000个单元格
- ⚡ 扫描性能 (应<1秒)
- ⚡ 内存使用控制
- ⚡ 大文件下载稳定性

**性能指标**:
- 扫描时间: <1秒
- 文件大小: ~20-30KB
- UI响应性: 无冻结

---

### 6. `hidden-tables.html` - 隐藏表格过滤
**测试目标**: 验证可见性过滤
- ✅ 过滤 `display: none` 表格
- ✅ 过滤 `visibility: hidden` 表格
- 🤔 其他隐藏方式处理
- 🔄 动态显示切换测试

**预期结果**: 只检测真正可见的表格

---

## 使用方法

### 1. 开发环境测试
```bash
# 启动开发服务器
bun run dev

# 在Chrome中加载扩展 (chrome://extensions/)
# 开启开发者模式，加载未打包的扩展
```

### 2. 测试步骤
1. 在浏览器中打开任一测试文件
2. 点击扩展图标打开popup
3. 查看检测到的表格列表
4. 点击"Export CSV"测试导出功能
5. 验证下载的CSV文件内容

### 3. 验证要点

#### 基础功能
- [ ] 表格数量正确识别
- [ ] 行列数显示准确
- [ ] 预览文本合理截断
- [ ] CSV文件成功下载

#### 特殊字符
- [ ] 逗号被引号包围
- [ ] 双引号正确转义
- [ ] 换行符保持原样
- [ ] 中文和Unicode字符无乱码

#### 性能表现
- [ ] 大表格扫描流畅
- [ ] 导出过程无卡顿
- [ ] 内存使用合理
- [ ] 错误处理正确

#### 边界情况
- [ ] 空表格处理
- [ ] 隐藏表格过滤
- [ ] 合并单元格稳定性
- [ ] 动态内容更新

## 问题排查

### 常见问题
1. **表格未检测到**: 检查CSS样式，确认表格可见
2. **导出失败**: 检查浏览器控制台错误信息
3. **乱码问题**: 确认UTF-8编码和BOM头
4. **性能问题**: 监控大表格处理时间

### 调试方法
```javascript
// 在控制台查看内容脚本
browser.tabs.sendMessage(tabId, { type: 'get_tables' })
  .then(console.log)
  .catch(console.error);
```

---

## 扩展特性验证清单

- [x] **T001 内容脚本**: 消息监听、表格扫描、CSV生成
- [x] **T002 Popup界面**: React组件、状态管理、错误处理  
- [x] **T003 清单配置**: 权限声明、脚本注册、popup入口
- [ ] **T004 错误处理**: 友好提示、性能优化、数据校验
- [ ] **T005 人工测试**: 多浏览器、真实网站、用例验证

通过这些测试文件，可以全面验证表格导出器的功能完整性和稳定性。