<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特殊字符表格示例 - Table Exporter Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .description {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        .quote-cell {
            color: #d63384;
        }
        .multiline-cell {
            color: #0d6efd;
        }
    </style>
</head>
<body>
    <h1>特殊字符表格示例</h1>
    
    <div class="description">
        <h3>测试目标</h3>
        <p>这个表格包含各种需要特殊处理的字符，用于测试CSV转义功能：</p>
        <ul>
            <li>逗号 (,) - CSV分隔符</li>
            <li>双引号 (") - CSV转义字符</li>
            <li>换行符 - 多行文本</li>
            <li>特殊符号和Unicode字符</li>
            <li>空白单元格</li>
        </ul>
    </div>

    <h2>特殊字符测试数据</h2>
    <table>
        <thead>
            <tr>
                <th>测试类型</th>
                <th>原始内容</th>
                <th>说明</th>
                <th>预期CSV结果</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>逗号测试</td>
                <td>苹果,香蕉,橙子</td>
                <td>包含CSV分隔符</td>
                <td class="quote-cell">"苹果,香蕉,橙子"</td>
            </tr>
            <tr>
                <td>引号测试</td>
                <td>他说"你好"然后离开了</td>
                <td>包含双引号</td>
                <td class="quote-cell">"他说""你好""然后离开了"</td>
            </tr>
            <tr>
                <td>换行测试</td>
                <td class="multiline-cell">第一行内容<br>第二行内容<br>第三行内容</td>
                <td>多行文本</td>
                <td class="quote-cell">"第一行内容\n第二行内容\n第三行内容"</td>
            </tr>
            <tr>
                <td>混合特殊字符</td>
                <td>名称: "产品A,B",<br>价格: ¥1,299.99</td>
                <td>逗号+引号+换行</td>
                <td class="quote-cell">"名称: ""产品A,B"",\n价格: ¥1,299.99"</td>
            </tr>
            <tr>
                <td>Unicode测试</td>
                <td>🎉 表情符号 ∑ 数学符号 © 版权符号</td>
                <td>特殊Unicode字符</td>
                <td>🎉 表情符号 ∑ 数学符号 © 版权符号</td>
            </tr>
            <tr>
                <td>空白测试</td>
                <td></td>
                <td>空单元格</td>
                <td>(空字符串)</td>
            </tr>
            <tr>
                <td>仅空格</td>
                <td>   </td>
                <td>仅包含空格</td>
                <td>   </td>
            </tr>
            <tr>
                <td>HTML标签测试</td>
                <td><strong>粗体</strong> 和 <em>斜体</em> 文本</td>
                <td>包含HTML标签</td>
                <td>粗体 和 斜体 文本</td>
            </tr>
        </tbody>
    </table>

    <div class="description">
        <h3>预期结果</h3>
        <p>使用扩展导出此表格时，应该：</p>
        <ul>
            <li>识别到 1 个表格 (8×4)</li>
            <li>所有包含逗号、引号或换行的单元格都被正确引用</li>
            <li>双引号被正确转义为双倍引号</li>
            <li>换行符保持为 \n</li>
            <li>HTML标签被移除，只保留文本内容</li>
            <li>Unicode字符正确保存</li>
            <li>空白单元格处理正确</li>
        </ul>
    </div>
</body>
</html>